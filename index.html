<!DOCTYPE html>
<html lang="it" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khaine | The Traveller Lifestyle</title>

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700;900&family=Playfair+Display:ital,wght@0,700;1,700&family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&family=JetBrains+Mono:wght@400&display=swap"
        rel="stylesheet">
</head>

<body class="bg-slate-50 text-slate-900">

    <!-- Component Placeholders -->
    <div id="header-placeholder"></div>
    <div id="main-placeholder"></div>
    <div id="modals-placeholder"></div>
    <div id="ritmo-placeholder"></div>
    <div id="vigore-placeholder"></div>
    <div id="venere-placeholder"></div>
    <div id="babymoon-placeholder"></div>
    <div id="montefeltro-placeholder"></div>
    <div id="footer-placeholder"></div>

    <!-- 1. Load Components (Define Global Strings) -->
    <script src="assets/js/components/header.js"></script>
    <script src="assets/js/components/main_section.js"></script>
    <script src="assets/js/components/footer.js"></script>

    <!-- Modals -->
    <script src="assets/js/components/modals/cope.js"></script> <!-- Defines window.copeModalHTML -->
    <script src="assets/js/components/modals/dublin.js"></script> <!-- Defines window.dublinModalHTML -->
    <script src="assets/js/components/modals/helsinki.js"></script> <!-- Defines window.helsinkiModalHTML -->
    <script src="assets/js/components/modals/disclaimer.js"></script> <!-- Defines window.disclaimerModalHTML -->
    <script src="assets/js/components/modals/blog.js"></script> <!-- Defines window.blogModalHTML -->
    <script src="assets/js/components/modals/contacts.js"></script> <!-- Defines window.contactsModalHTML -->
    <script src="assets/js/components/modals/about.js"></script> <!-- Defines window.aboutModalHTML -->
    <script src="assets/js/components/modals/kit.js"></script> <!-- Defines window.kitModalHTML -->
    <script src="assets/js/components/modals/biohack.js"></script> <!-- Defines window.biohackModalHTML -->
    <script src="assets/js/components/modals/ritmo.js"></script>
    <script src="assets/js/components/modals/vigore.js"></script>
    <script src="assets/js/components/modals/venere.js"></script>
    <script src="assets/js/components/modals/babymoon.js"></script> <!-- Defines window.babymoonModalHTML -->
    <script src="assets/js/components/modals/montefeltro.js"></script>
    <script src="assets/js/components/modals/souls_sounds.js"></script>
    <script src="assets/js/components/modals/souls_food.js"></script>
    <script src="assets/js/components/modals/recipe_salmon.js"></script>
    <script src="assets/js/components/modals/recipe_chicken_turmeric.js"></script>
    <script src="assets/js/components/modals/recipe_curry.js"></script>
    <script src="assets/js/components/modals/recipe_lemon.js"></script>
    <script src="assets/js/components/modals/recipe_skillingsboller.js"></script>
    <script src="assets/js/components/modals/links.js"></script>
    <!-- Defines window.linksModalHTML (Includes boscolo + link2detail) -->

    <!-- 2. Load Logic (Defines window.initLogic) -->
    <script src="assets/js/logic.js"></script>

    <!-- 3. Make toggleModal Available Immediately -->
    <script>
        // Global toggleModal function - Make it available BEFORE injection
        window.toggleModal = function(modalId) {
            if (!modalId) return;
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.toggle('modal-active');
                if (modal.classList.contains('modal-active')) {
                    modal.scrollTop = 0;
                    const innerScrollable = modal.querySelectorAll('.overflow-y-auto');
                    innerScrollable.forEach(el => {
                        el.scrollTop = 0;
                    });
                }
                const anyModalActive = document.querySelector('.modal-active');
                document.body.style.overflow = anyModalActive ? 'hidden' : 'auto';
            }
        };
    </script>

    <!-- 4. Inject and Initialize -->
    <script>
        // Inject Content
        if (window.headerHTML) document.getElementById('header-placeholder').outerHTML = window.headerHTML;
        if (window.mainHTML) document.getElementById('main-placeholder').outerHTML = window.mainHTML;
        if (window.footerHTML) document.getElementById('footer-placeholder').outerHTML = window.footerHTML;

        // Concatenate Modals
        const allModals = [
            window.copeModalHTML,
            window.dublinModalHTML,
            window.helsinkiModalHTML,
            window.disclaimerModalHTML,
            window.blogModalHTML,
            window.contactsModalHTML,
            window.aboutModalHTML,
            window.kitModalHTML,
            window.biohackModalHTML,
            // window.ritmoModalHTML is injected separately below
            window.linksModalHTML,
            window.soulsFoodModalHTML,
            window.recipeSalmonModalHTML,
            window.recipeChickenTurmericModalHTML,
            window.recipeCurryModalHTML,
            window.recipeLemonModalHTML,
            window.recipeSkillingsbollerModalHTML
        ].join('\n');

        document.getElementById('modals-placeholder').outerHTML = allModals;

        // Inject Ritmo Modal Separately
        if (window.ritmoModalHTML) {
            document.getElementById('ritmo-placeholder').outerHTML = window.ritmoModalHTML;
        }

        if (window.vigoreModalHTML) {
            document.getElementById('vigore-placeholder').outerHTML = window.vigoreModalHTML;
        }

        if (window.venereModalHTML) {
            document.getElementById('venere-placeholder').outerHTML = window.venereModalHTML;
        }

        if (window.babymoonModalHTML) {
            document.getElementById('babymoon-placeholder').outerHTML = window.babymoonModalHTML;
        }

        if (window.montefeltroModalHTML) {
            document.getElementById('montefeltro-placeholder').outerHTML = window.montefeltroModalHTML;
        }

        if (window.soulsSoundsModalHTML) {
            document.body.insertAdjacentHTML('beforeend', window.soulsSoundsModalHTML);
        }

        // Initialize Logic (Event Listeners etc.)
        if (window.initLogic) {
            window.initLogic();
            console.log("Logic initialized successfully.");
        } else {
            console.error("Logic script not loaded properly.");
        }
    </script>
</body>

</html>